# Abstract
[BerlinMOD](http://dna.fernuni-hagen.de/secondo/BerlinMOD/BerlinMOD.html) is a benchmark for spatio-temporal database management systems. The benchmark generates trips of moving vehicles within Berlin. BerlinMODPlayer is a player for such trips. The Player reads the data generated by BerlinMOD and generates a stream of GPS coordinates therefrom. The stream of GPS coordinates can be used to benchmark stream processing systems.

# Introduction
Stream processing systems are used to process the content of data streams. Such data streams are often generated when moving or changing objects are observed and the observation is recorded progressive. For example, the changing price of
a stock, the speed of an engine or the position of a vehicle. BerlinMOD is a benchmark that generates trips of moving vehicles within Berlin. BerlinMODPlayer is a software that reads the generated trips and creates a stream of GPS coordinates therefrom. That stream is written to a TCP socket. In a real world scenario, such data stream is generated by a fleet of vehicles moving through the streets of a city and sending their GPS coordinates to a central system.

## Basics
A movement beginning at the coordinate _(xstart, ystart)_ and ending at the coordinate _(xend, yend)_ will be called trip in this paper. A trip is composed of smaller movements, called units (as illustrated in Fig. 1). Trips and units 1 are describing a movement, starting at time t0 and ending at time t1. Inside the interval [t0, t1] the trip is called valid. Outside this time interval, the trip is invalid.

![Figure 1](doc/images/trips.png)

Figure 1: The trip on a map from point A to point B is composed of three units (u1, u2, u3).

## BerlinMod
BerlinMOD is a benchmark for spatio-temporal database management systems. This benchmark includes a generator for moving objects and a set of queries to benchmark the performance of a database management system. In this paper, the data generator is used to create the input data (further called the input file) for BerlinMODPlayer. The basic idea of the data generator of BerlinMOD is to define a set of vehicles and to generate trips on the street network of Berlin. Each vehicle has a HomeNode, representing the holder’s residence and a WorkNode, representing the working place of the holder. Additionally, a set of nodes in the Neighborhood around the HomeNode are used. The data generator creates trips from the HomeNode to the WorkNode and trips to the nodes in the neighborhood. For more details about the creation of trips, see [the BerlinMOD homepage](http://dna.fernuni-hagen.de/secondo/BerlinMOD/BerlinMOD.html). The data generator of BerlinMOD consists of a set of quires for the the extensible database management system (http://dna.fernuni-hagen.de/secondo/)[Secondo].

# BerlinMODPlayer
The following subsections will describe the basic concepts of the BerlinMODPlayer. In addition, the architecture of the software will be discussed. BerlinMODPlayer simulates the movement of vehicles. Consequently, the execution of the software will also referred as _simulation_.

## Command line arguments
The software accepts some arguments, to influence the program behavior and the generated data stream. So, the begin time and the end time of the simulation can be settled, the destination host and port can be specified, to name just a few of the arguments.

| Parameter |        Name       |         Description                 |
|-----------|-------------------|-------------------------------------|
| -i        | Input file        | The file name of the input file.    |
| -u        | Output URL        | The format and the transport for the output. |
| -s        | Simulation mode   | The simulation mode that should be used |
| -o        | Output file       | The output file for the statistics   |
| -b        | Begin time offset | Optional: The time when the simulation should begin. If the parameter is omitted, the simulation begins with the first line of the input file. The time has to be specified in the format: `yyyy-mmm-dd hh:mm:ss` |
| -e        | End time offset   | Optional: The time when the simulation should end. If the parameter is omitted, the simulation ends with the last line of the input file. |

__Example__: Run the BerlinMODPlayer and send the GPS updates to localhost port 10 025 (TCP) in CSV format using the adaptive simulation mode. The statistics are written into the file statistics.txt. The file trips.csv contains
the data generated by BerlinMOD.

    ./bmodplayer -i trips.csv -u tcp://localhost/10025 -s adaptive -o statistics.txt

## Statistics
During the program execution, statistical information of the simulation is written to an output file. This file contains a line for every second of the simulation. Every line consists of five fields: (i) the first field contains the number of seconds passed since the simulation has begun. (ii) The second field contains the amount of read lines from the input file. (iii) The third field contains the amount of written lines on the network socket. (iv) The fourth field contains the amount of read tuples in the last second. (v) The last field contains the amount of sent tuples in the last second.

```
#Sec  Read  Write   Diff read   Diff send
0     0     0       0           0
1     65554 55460   65554       55460
2     135112 124987 69558       69527
[...]
### Total execution time (ms): 11004
### Read: 459974
### Send: 459974
```

The format of the file can easily processed with tools like Gnuplot. The last three lines of the file describe the total execution time of the simulation and the total amount of read and written coordinates.

## The GPS coordinate data stream
BerlinMODPlayer generates a stream of GPS coordinates. The output URL determines the output transport and the output format. Currently, two different output formats and transports are supported: (i) the data can be send in the CSV format (Comma-separated values) via a TCP socket or (ii) the data can be send in the JSON format (JavaScript Object Notation) [5] via HTTP requests. Both formats and transports are discussed in the next sections. The next table describes the structure of the supported output URLs.

